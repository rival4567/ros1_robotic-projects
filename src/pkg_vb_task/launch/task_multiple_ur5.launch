<launch>
    
    <!-- Spawn Task-3 Models in Gazebo -->
    <include file="$(find pkg_vb_task)/launch/task_sort_world.launch" />

    <group ns="ur5_1">
        <param name="tf_prefix" value="ur5_1_tf" />
        <include file="$(find pkg_vb_task)/launch/gazebo_spawn_ur5.launch">
            <arg name="init_pose" value="-x 0 -y 0.5 -z 0.0"/>
            <arg name="robot_name" value="ur5_1"/>
        </include>
    </group>

    <group ns="ur5_2">
        <param name="tf_prefix" value="ur5_2_tf" />
        <include file="$(find pkg_vb_task)/launch/gazebo_spawn_ur5.launch">
            <arg name="init_pose" value="-x -1.5 -y -0.3 -z 0.0 -Y 3.14"/>
            <arg name="robot_name" value="ur5_2"/>
        </include>
    </group>

    <!-- Launch the two ur5 arms with MoveIt! in RViz -->
    <include file="$(find pkg_vb_sim)/launch/two_ur5_move_group.launch" />

    <!-- Spawn Boxes -->
    <node name= "task_spawn_models" pkg= "pkg_vb_task" type="node_spawn_models.py"/>

    <!-- TF Broadcaster to merge TFs of ur5_1 and ur5_2 with world frame -->
    <!-- <node name= "node_merge_tf" pkg= "pkg_vb_task" type="node_merge_tf.py"/> -->


    <!-- Start Vacuum Gripper Service for the two UR5s -->
    <rosparam file ="$(find pkg_vb_sim)/config/config_vacuum_gripper.yaml"/>
    <node name= "node_service_server_vacuum_gripper_ur5_1" pkg= "pkg_vb_sim" type="node_service_server_vacuum_gripper_ur5_1.py" output="screen"/>
    <node name= "node_service_server_vacuum_gripper_ur5_2" pkg= "pkg_vb_sim" type="node_service_server_vacuum_gripper_ur5_2.py" output="screen"/>

    <!-- Run Conveyor Belt Service Server -->
    <node name= "node_conveyor_belt" pkg= "pkg_vb_task" type="node_conveyor_belt.py" output="screen"/>
	
</launch>